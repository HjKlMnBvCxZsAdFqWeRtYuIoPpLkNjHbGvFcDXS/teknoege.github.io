<!DOCTYPE html>
<html lang="tr">
<head>
    <meta charset="UTF-8">
    <title>Sistem TanÄ±lama Modu</title>
    <style>
        body { font-family: monospace; background: #111; color: #0f0; padding: 20px; line-height: 1.5; }
        .log-item { margin-bottom: 10px; border-bottom: 1px dotted #333; }
        .error { color: #ff4757; font-weight: bold; }
        .success { color: #2ed573; }
        .info { color: #1e90ff; }
    </style>
</head>
<body>
    <h2>ğŸš€ Sistem TanÄ±lama BaÅŸlatÄ±ldÄ±...</h2>
    <div id="console"></div>

    <script>
        const logger = document.getElementById('console');
        const csvUrl = 'https://docs.google.com/spreadsheets/d/e/2PACX-1vQaW8jI2Wt3qkwq6vviJpIHgkGG4I37e2qgOaQaasss_-ZHa0qmTTunIAzbHh6h99jHbrpK6yRKUIvP/pub?gid=0&single=true&output=csv';

        function log(msg, type = 'info') {
            const div = document.createElement('div');
            div.className = `log-item ${type}`;
            div.innerHTML = `[${new Date().toLocaleTimeString()}] ${msg}`;
            logger.appendChild(div);
        }

        async function testSistemi() {
            log("1. AdÄ±m: Google Sheets baÄŸlantÄ±sÄ± deneniyor...");
            
            try {
                const response = await fetch(csvUrl + "&cache=" + Math.random(), {
                    method: 'GET',
                    mode: 'cors'
                });

                log(`2. AdÄ±m: Sunucu yanÄ±t verdi. Durum Kodu: ${response.status}`, response.ok ? 'success' : 'error');

                if (!response.ok) {
                    log("HATA: Google dosyayÄ± bulamadÄ± veya eriÅŸim izni yok (404/403).", "error");
                    return;
                }

                const data = await response.text();
                log("3. AdÄ±m: Veri baÅŸarÄ±yla indirildi.");
                log(`4. AdÄ±m: Ham Veri Ä°Ã§eriÄŸi: <br><pre style="background:#222; padding:10px;">${data}</pre>`);

                if (data.includes("<!DOCTYPE html>")) {
                    log("KRÄ°TÄ°K HATA: Link sayÄ± yerine bir HTML sayfasÄ± dÃ¶ndÃ¼rÃ¼yor! 'Web'de YayÄ±nla' ayarÄ±nÄ± CSV olarak tekrar yapmalÄ±sÄ±n.", "error");
                } else {
                    const match = data.match(/\d+/);
                    if (match) {
                        log(`SONUÃ‡: BaÅŸarÄ±lÄ±! Bulunan SayÄ±: ${match[0]}`, "success");
                    } else {
                        log("HATA: Dosya indi ama iÃ§inde rakam bulunamadÄ±.", "error");
                    }
                }

            } catch (err) {
                log(`KRÄ°TÄ°K HATA: BaÄŸlantÄ± tamamen engellendi! <br>Detay: ${err.message}`, "error");
                log("Tavsiye: TarayÄ±cÄ± eklentilerini (AdBlock vb.) kapatÄ±p dene veya Cloudflare Ã¼zerinde SSL ayarlarÄ±nÄ± kontrol et.", "info");
            }
        }

        testSistemi();
    </script>
</body>
</html>
